# [Windows端口开启关闭](https://www.cnblogs.com/shenyiyangle/p/10503754.html)

[![复制代码](https://common.cnblogs.com/images/copycode.gif)](javascript:void(0);)

```
netstat-a  #显示所有活动的TCP连接以及计算机监听的TCP和UDP端口。
netstat-e  #显示以太网发送和接收的字节数、数据包数等。
netstat-n  #以数字形式显示所有活动的TCP连接的地址和端口号。
netstat-o  #显示活动的TCP连接并包括每个连接的进程ID（PID）。
netstat-s  #按协议显示各种连接的统计信息，包括端口号。
netstat-an #查看所有开放的端口。
```

[![复制代码](https://common.cnblogs.com/images/copycode.gif)](javascript:void(0);)

# 1. 查看端口占用

在windows命令行窗口下执行：

```
netstat -aon|findstr "8080"
```

 运行结果：

```
TCP  127.0.0.1:80    0.0.0.0:0    LISTENING   2448
```

端口“8080”被PID（进程号）为2448的进程占用。
查看端口“8080”被哪个应用占用，，继续执行下面命令：

```
tasklist|findstr "2448"
```

运行结果：

```
notepad.exe        2016 Console         0     16,064 K
```

# 2. 关闭进程

## 2.1 按进程号关闭进程

taskkill /pid 2152多个时格式为：

```
taskkill /pid 2152 /pid 1284
```

## 2.2 按进程名关闭进程

如要关闭notepad.exe,格式为：

```
taskkill /im notepad.exe
```

指定多个时格式为：

```
taskkill /im notepad.exe /im iexplorer.exe
```

如果是要关闭所有的,则使用通配符*,即：

```
taskkill /im *.exe
```

## 2.3 有提示的关闭进程

```
taskkill /t /im notepad.exe
taskkill /t /pid 2152
```

这个效果是提示后在使用者确定后关闭,有提示框。

## 2.4 强行终止进程

```
taskkill /f /im notepad.exe
taskkill /f /pid 2152
```

# 3. 端口状态

## 3.1 LISTENING状态

FTP服务启动后首先处于侦听（LISTENING）状态。

## 3.2 ESTABLISHED状态

ESTABLISHED的意思是建立连接。表示两台机器正在通信。

## 3.3 CLOSE_WAIT

对方主动关闭连接或者网络异常导致连接中断，这时我方的状态会变成CLOSE_WAIT 此时我方要调用close()来使得连接正确关闭

## 3.4 TIME_WAIT

我方主动调用close()断开连接，收到对方确认后状态变为TIME_WAIT。TCP协议规定TIME_WAIT状态会一直持续2MSL(即两倍的分段最大生存期)，以此来确保旧的连接状态不会对新连接产生影响。处于TIME_WAIT状态的连接占用的资源不会被内核释放，所以作为服务器，在可能的情况下，尽量不要主动断开连接，以减少TIME_WAIT状态造成的资源浪费。
目前有一种避免TIME_WAIT资源浪费的方法，就是关闭socket的LINGER选项。但这种做法是TCP协议不推荐使用的，在某些情况下这个操作可能会带来错误。

## 3.5 SYN_SENT状态

SYN_SENT状态表示请求连接，当你要访问其它的计算机的服务时首先要发个同步信号给该端口，此时状态为SYN_SENT，如果连接成功了就变为ESTABLISHED，此时SYN_SENT状态非常短暂。但如果发现SYN_SENT非常多且在向不同的机器发出，那你的机器可能中了冲击波或震荡波之类的病毒了。这类病毒为了感染别的计算机，它就要扫描别的计算机，在扫描的过程中对每个要扫描的计算机都要发出了同步请求，这也是出现许多SYN_SENT的原因。
限制或关闭端口的方法：
　　1、通过系统自带功能“限制开放”需要的端口（Win2000/XP/server2003）
　　通过系统自有的“TCP/IP筛选功能”限制服务器端口，控制面板-网络连接-“本地连接”-右键-属性，然后选择internet(tcp/ip)-属性-高级-选项-选中TCP/IP筛选-属性，在这里分为3项，分别是TCP、UDP、IP协议，假设我的系统只想开放21、80、25、110这4个端口(qq为4000端口），只要在“TCP端口”上勾选“只允许”然后点击“添加”依次把这些端口添加到里面，然后确定，重新启动后生效。
　　2、通过系统自带防火墙增加“允许通过”的端口
　　（1）未升级SP2的WINXP/Server2003
　　控制面板-网络连接-本地连接-属性-高级，把“Inernet连接防火墙”下面的选项勾选上，这样防火墙就自动启动了，点击“设置”，我们可以在“高级设置”窗口的“服务”选项卡中点击“添加”按钮，在“服务设置”对话框中，把服务描述、计算机名或IP地址、端口号、是TCP or UDP，填完后打勾确认，如果不需要了去掉勾确认。（防火墙启动以后“本地连接”图标会出现一个可爱的小锁头。）
　　（2）升级WIin XP SP2的Windows XP
　　控制面版-windows防火墙-例外-添加端口，在取名后，输入端口号，确认TCP或者UDP协议，然后确认，在你取名的这个设置前打勾，表示允许通过此端口，不打勾表示不例外。
　　3、利用带有的“本地安全策略”功能关闭端口（WINXP HOME版本无此功能）
　　关闭TCP：135（Win2000、WinXP防止RPC135溢出漏洞）、139、445（注册表“HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters”中追加名为“SMBDeviceEnabled”的DWORD值，并将其设置为0能禁用445端口）、593、1025 和UDP：135、137、138、445 端口，关闭一些流行病毒的后门端口（如 TCP 2745、3127、6129 端口），以及远程服务访问端口3389。以下看步骤，共8个。
　　⑴ 控制面板-管理工具，打开“本地安全策略”，选中“IP 安全策略，在本地计算机”，在右边窗口的空白处右击鼠标，弹出快捷菜单，选择“创建 IP 安全策略”，于是弹出一个向导，在向导中点击“下一步”按钮，为新的安全策略命名；再按“下一步”，则显示“安全通信请求”画面，在画面上把“激活默认相应规则”左边的钩去掉，点击“完成”按钮就创建了一个新的IP 安全策略。
　　⑵ 右击该IP安全策略，在“属性”对话框中，把“使用添加向导”左边的钩去掉，然后单击“添加”按钮添加新的规则，随后弹出“新规则属性”对话框，在画面上点击“添加”按钮，弹出IP筛选器列表窗口；在列表中，首先把“使用添加向导”左边的钩去掉，然后再点击右边的“添加”按钮添加新的筛选器。
　　⑶ 进入“筛选器属性”对话框，首先看到的是寻址，源地址选“任何 IP 地址”，目标地址选“我的 IP 地址”；点击“协议”选项卡，在“选择协议类型”的下拉列表中选择“TCP”，然后在“到此端口”下的文本框中输入“135”，点击“确定”按钮，这样就添加了一个屏蔽 TCP 135（RPC）端口的筛选器，它可以防止外界通过135端口连上你的电脑。
　　⑷ 点击“确定”后回到筛选器列表的对话框，可以看到已经添加了一条策略，重复以上步骤继续添加 TCP 137、139、445、593 端口和 UDP 135、139、445 端口，为它们建立相应的筛选器。
　　⑸ 重复以上步骤添加TCP 1025、2745、3127、6129、3389 端口的屏蔽策略，建立好上述端口的筛选器，最后点击“确定”按钮。
　　⑹ 在“新规则属性”对话框中，选择“新 IP 筛选器列表”，然后点击其左边的圆圈上加一个点，表示已经激活，最后点击“筛选器操作”选项卡。在“筛选器操作”选项卡中，把“使用添加向导”左边的钩去掉，点击“添加”按钮，添加“阻止”操作，在“新筛选器操作属性”的“安全措施”选项卡中，选择“阻止”，然后点击“确定”按钮。
　　⑺ 进入“新规则属性”对话框，点击“新筛选器操作”，其左边的圆圈会加了一个点，表示已经激活，点击“关闭”按钮，关闭对话框；最后回到“新IP安全策略属性”对话框，在“新的IP筛选器列表”左边打钩，按“确定”按钮关闭对话框。在“本地安全策略”窗口，用鼠标右击新添加的 IP 安全策略，然后选择“指派”。
　　⑻ 完后重启电脑，这些端口就被关闭了~~

# 4、利用关闭系统服务的同时关闭端口

　　控制面板－管理工具－服务。
　　⑴ 关闭7.9等等端口：关闭Simple TCP/IP Service,支持以下 TCP/IP 服务：Character Generator, Daytime, Discard, Echo, 以及 Quote of the Day。
　　⑵ 关闭80端口：关掉WWW服务。在“服务”中显示名称为"World Wide Web Publishing Service"，通过 Internet 信息服务的管理单元提供 Web 连接和管理。
　　⑶ 关掉25端口：关闭Simple Mail Transport Protocol (SMTP)服务，它提供的功能是跨网传送电子邮件。
　　⑷ 关掉21端口：关闭FTP Publishing Service,它提供的服务是通过 Internet 信息服务的管理单元提供 FTP 连接和管理。
　　⑸ 关掉23端口：关闭Telnet服务，它允许远程用户登录到系统并且使用命令行运行控制台程序。
　　⑹ 关闭server服务，此服务提供 RPC 支持、文件、打印以及命名管道共享。关掉它就关掉了win2k的默认共享，比如ipc$、c$、admin$等等，此服务关闭不影响您的共他操作。
　　⑺ 关闭139端口，139端口是NetBIOS Session端口，用来文件和打印共享，注意的是运行samba的unix机器也开放了139端口，功能一样。以前流光2000用来判断对方主机类型不太准确，估计就是139端口开放既认为是NT机，现在好了。
　　关闭方法：在“网络连接”中“本地连接”中选取“Internet协议(TCP/IP)”属性，进入“高级TCP/IP设置”“WINS设置”里面有一项“禁用TCP/IP的NETBIOS”，打勾就关闭了139端口。 对于个人用户来说，可以在各项服务属性设置中设为“禁用”，以免下次重启服务也重新启动，端口也开放了。

# 5、通过第三方防火墙来关闭端口

　　例如国内的：天网，金山，瑞星；国外的：诺顿，IIS。这类防火墙关闭端口就比较方便了，添加关闭就OK了，一般都有专门的设置选项。下载哪个防火墙看其帮助设置吧~。